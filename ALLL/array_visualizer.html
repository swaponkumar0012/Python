<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Array Operations Visualization</title>

    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>

    <!-- React & ReactDOM -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>

    <!-- Babel -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <!-- Google Fonts -->
    <link
        href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800&family=JetBrains+Mono:wght@400;700&display=swap"
        rel="stylesheet">

    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['Inter', 'sans-serif'],
                        mono: ['JetBrains Mono', 'monospace'],
                    },
                    colors: {
                        brand: {
                            dark: '#0f172a',
                            light: '#e2e8f0',
                            accent: '#3b82f6',
                            success: '#10b981',
                            error: '#ef4444',
                            warning: '#f59e0b',
                        }
                    }
                }
            }
        }
    </script>

    <style>
        body {
            background-color: #0f172a;
            color: #e2e8f0;
        }

        .glass-panel {
            background: rgba(30, 41, 59, 0.7);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .array-item-enter {
            animation: popIn 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }

        @keyframes popIn {
            0% {
                opacity: 0;
                transform: scale(0.5) translateY(20px);
            }

            100% {
                opacity: 1;
                transform: scale(1) translateY(0);
            }
        }
    </style>
</head>

<body class="min-h-screen flex flex-col items-center justify-center p-4 selection:bg-brand-accent selection:text-white">

    <div id="root" class="w-full max-w-5xl"></div>

    <script type="text/babel">
        const { useState, useEffect, useRef } = React;

        const App = () => {
            const [array, setArray] = useState([]);
            const [inputValue, setInputValue] = useState('');
            const [message, setMessage] = useState('Ready for operations');
            const [highlightIndices, setHighlightIndices] = useState([]); // Indices being compared/scanned
            const [foundIndex, setFoundIndex] = useState(null); // Index where element was found
            const [isSorting, setIsSorting] = useState(false);
            const [isSearching, setIsSearching] = useState(false);

            // Helper to delay execution for animation
            const delay = (ms) => new Promise(resolve => setTimeout(resolve, ms));

            // --- Operations ---

            const handleAdd = () => {
                if (!inputValue) {
                    setMessage("Please enter a number.");
                    return;
                }
                const num = parseInt(inputValue);
                if (isNaN(num)) {
                    setMessage("Invalid number.");
                    return;
                }

                setArray(prev => [...prev, num]);
                setInputValue('');
                setMessage(`Added ${num} to the array.`);
                setFoundIndex(null);
                setHighlightIndices([]);
            };

            const handleDelete = () => {
                if (!inputValue) {
                    setMessage("Enter a number to delete.");
                    return;
                }
                const num = parseInt(inputValue);

                if (array.includes(num)) {
                    setArray(prev => prev.filter(item => item !== num));
                    setMessage(`Deleted ${num} from the array.`);
                } else {
                    setMessage(`Element ${num} not found.`);
                }
                setInputValue('');
                setFoundIndex(null);
                setHighlightIndices([]);
            };

            const handleSearch = async () => {
                if (!inputValue) {
                    setMessage("Enter a number to search.");
                    return;
                }
                const target = parseInt(inputValue);
                setIsSearching(true);
                setFoundIndex(null);
                setMessage(`Searching for ${target}...`);

                for (let i = 0; i < array.length; i++) {
                    setHighlightIndices([i]);
                    await delay(600); // Wait to show scan

                    if (array[i] === target) {
                        setFoundIndex(i);
                        setMessage(`Found ${target} at index ${i}!`);
                        setIsSearching(false);
                        return;
                    }
                }

                setHighlightIndices([]);
                setMessage(`${target} not found in the array.`);
                setIsSearching(false);
            };

            const handleSort = async () => {
                setIsSorting(true);
                setFoundIndex(null);
                setMessage("Sorting array (Bubble Sort)...");

                // Create a copy to manipulate
                let tempArr = [...array];
                let len = tempArr.length;
                let swapped;

                do {
                    swapped = false;
                    for (let i = 0; i < len - 1; i++) {
                        // Highlight comparing pair
                        setHighlightIndices([i, i + 1]);
                        await delay(500);

                        if (tempArr[i] > tempArr[i + 1]) {
                            // Swap
                            let temp = tempArr[i];
                            tempArr[i] = tempArr[i + 1];
                            tempArr[i + 1] = temp;
                            swapped = true;

                            // Update state to show swap
                            setArray([...tempArr]);
                            await delay(500);
                        }
                    }
                    len--; // Optimization: last element is already in place
                } while (swapped);

                setHighlightIndices([]);
                setMessage("Array sorted successfully.");
                setIsSorting(false);
            };

            // --- Render ---

            return (
                <div class="flex flex-col gap-8 w-full">

                    {/* Header */}
                    <div class="text-center space-y-2">
                        <h1 class="text-4xl md:text-5xl font-black bg-clip-text text-transparent bg-gradient-to-r from-blue-400 to-purple-500">
                            Array Visualizer
                        </h1>
                        <p class="text-slate-400 font-mono text-sm">Interactive visualization of your Python script</p>
                    </div>

                    {/* Visualization Stage */}
                    <div class="glass-panel rounded-2xl p-8 min-h-[300px] flex flex-col items-center justify-center relative overflow-hidden shadow-2xl">

                        {/* Status Message */}
                        <div class="absolute top-4 left-0 right-0 text-center">
                            <span class={`inline-block px-4 py-1 rounded-full text-sm font-bold tracking-wide transition-colors duration-300
                                ${message.includes('Found') || message.includes('sorted') ? 'bg-green-500/20 text-green-400' :
                                    message.includes('not found') ? 'bg-red-500/20 text-red-400' :
                                        'bg-blue-500/10 text-blue-300'}`}>
                                {message}
                            </span>
                        </div>

                        {/* Array Items */}
                        <div class="flex flex-wrap items-end justify-center gap-3 mt-8">
                            {array.map((value, idx) => {
                                const isHighlighted = highlightIndices.includes(idx);
                                const isFound = foundIndex === idx;

                                return (
                                    <div
                                        key={idx}
                                        className={`
                                            array-item-enter transform transition-all duration-500 ease-in-out
                                            flex flex-col items-center gap-2 group
                                        `}
                                    >
                                        {/* Bar/Block representation */}
                                        <div
                                            className={`
                                                w-14 h-14 md:w-20 md:h-20 rounded-xl flex items-center justify-center
                                                text-xl md:text-3xl font-bold shadow-lg border-2
                                                ${isFound
                                                    ? 'bg-green-500 border-green-400 text-white scale-110 shadow-green-500/50'
                                                    : isHighlighted
                                                        ? 'bg-yellow-500 border-yellow-400 text-white scale-110 shadow-yellow-500/50'
                                                        : 'bg-slate-700 border-slate-600 text-slate-200 hover:border-blue-400 hover:bg-slate-600'
                                                }
                                            `}
                                        >
                                            {value}
                                        </div>
                                        {/* Index Label */}
                                        <span class="text-xs font-mono text-slate-500 group-hover:text-slate-300 transition-colors">
                                            idx:{idx}
                                        </span>
                                    </div>
                                );
                            })}

                            {array.length === 0 && (
                                <div class="text-slate-500 italic">Array is empty</div>
                            )}
                        </div>
                    </div>

                    {/* Controls */}
                    <div class="glass-panel p-6 rounded-2xl">
                        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4">

                            {/* Input Group */}
                            <div class="lg:col-span-1 flex flex-col gap-2">
                                <label class="text-xs font-bold text-slate-400 uppercase tracking-wider">Target Value</label>
                                <input
                                    type="number"
                                    value={inputValue}
                                    onChange={(e) => setInputValue(e.target.value)}
                                    placeholder="Enter number..."
                                    class="w-full bg-slate-800 border-2 border-slate-700 rounded-lg px-4 py-2 text-white focus:outline-none focus:border-blue-500 transition-colors font-mono"
                                    disabled={isSorting || isSearching}
                                />
                            </div>

                            {/* Action Buttons */}
                            <div class="lg:col-span-3 grid grid-cols-2 md:grid-cols-4 gap-3">
                                <button
                                    onClick={handleAdd}
                                    disabled={isSorting || isSearching}
                                    class="bg-blue-600 hover:bg-blue-500 disabled:opacity-50 disabled:cursor-not-allowed text-white font-bold py-2 px-4 rounded-lg shadow-lg shadow-blue-600/20 transition-all active:scale-95"
                                >
                                    Add
                                </button>
                                <button
                                    onClick={handleDelete}
                                    disabled={isSorting || isSearching}
                                    class="bg-red-600 hover:bg-red-500 disabled:opacity-50 disabled:cursor-not-allowed text-white font-bold py-2 px-4 rounded-lg shadow-lg shadow-red-600/20 transition-all active:scale-95"
                                >
                                    Delete
                                </button>
                                <button
                                    onClick={handleSearch}
                                    disabled={isSorting || isSearching}
                                    class="bg-purple-600 hover:bg-purple-500 disabled:opacity-50 disabled:cursor-not-allowed text-white font-bold py-2 px-4 rounded-lg shadow-lg shadow-purple-600/20 transition-all active:scale-95 flex items-center justify-center gap-2"
                                >
                                    {isSearching && <span class="animate-spin">‚è≥</span>} Search
                                </button>
                                <button
                                    onClick={handleSort}
                                    disabled={isSorting || isSearching}
                                    class="bg-green-600 hover:bg-green-500 disabled:opacity-50 disabled:cursor-not-allowed text-white font-bold py-2 px-4 rounded-lg shadow-lg shadow-green-600/20 transition-all active:scale-95 flex items-center justify-center gap-2"
                                >
                                    {isSorting && <span class="animate-spin">üîÑ</span>} Sort
                                </button>
                            </div>
                        </div>
                    </div>

                    {/* Footer */}
                    <div class="text-center text-slate-600 text-sm">
                        Antigravity Engine &bull; React Visualization
                    </div>

                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>

</html>